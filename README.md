# Prj_myNas
개인용 헤놀로지 자작 NAS 구축

## :computer: Used
- VMware Workstation
- iptime
- DS3615xs

## :memo: NAS 구축한 이유
![image](https://user-images.githubusercontent.com/40004210/133265585-64a756af-34f6-4af7-9a3f-85895f26441c.png)  
전산실에서 시놀로지를 처음 발견하고 문득 내가 NAS를 만들 수 없을까 의문이 들게됨. 헤놀로지란 가상머신으로 동작하는 스토리지의 존재를 발견! 사실 클라우드 서비스를 이용해도 됐지만 좀 더 의미있는 작업이 되지 않을까해서 시작하게됨.

## :mag: 준비 과정
![image](https://user-images.githubusercontent.com/40004210/133265875-ea3eb8b0-1437-4ab5-afeb-d55a4db6a0e0.png)  
우선 미래를 생각하여 용량이 크고 안정적인 HDD가 필요했음. 따라서 진동에 안정적이고 A/S가 보장되는 WD HDD RED 3TB를 구매함. 가격은 14만원 정도 했던걸로 기억함.

그러면 앞으로 내 데스크톱에는 24시간 가상머신이 돌아가야 하기 때문에 부품 교체가 필요하다는 것을 느낌. 따라서 CPU를 저전력으로 변경하고 RAM을 저전력 32GB로 업그레이드함. 이때 나의 메인보드가 DDR3밖에 지원한다는 충격을 맛봄.

이후, 부품들이 도착하기 전까지 관련 정보를 배우기 위해 여러 전문가에게 자문을 구함.

## :clipboard: 결과
![image](https://user-images.githubusercontent.com/40004210/133266732-cffc2dde-f239-4852-888f-10568c6cd850.png)   
![image](https://user-images.githubusercontent.com/40004210/133267605-080f6cde-c5c1-415b-972c-b09e9ab5de30.png)   
![image](https://user-images.githubusercontent.com/40004210/133267182-85923a0a-3d45-450c-823f-d7522323cd3f.png)   

결론부터 말하면 구축 성공!
일주일 동안 안정적인 스토리지를 구현하기 위해서 정말 이것만 알아본 것 같음...
만약 밖에서 중요한 업무를 진행 중인데 컴퓨터가 꺼진다면? 파일이 날아간다면? 전송이 중지된다면?
끔찍하다...

어쨌거나 진행하면서 겪었던 문제점을 하나 씩 살펴보자면!

**공유기 이슈**
우리집은 SK 공유기를 사용하는데 공인 IP 211.xxx.xxx.xxx 이기 때문에 보안에 취약했다. 그리고 DDNS나 포트 서비스 지원이 어려웠고 무엇보다 전원을 밖에서 끌 수 있는 WOL 기능이 필요했다. 만약, 나때문에 공유기를 재부팅하면 1분간 가족들이 사용하지 못하는 상황도 발생했다.

그래서 iptime을 저렴하게 구매해서 사설 ip로 사용하고자 했다. 우선 SK공유기-iptime-PC가 연결됐다면 dual 모드를 이용하여 (SK공유기-iptime)-PC와 같은 환경을 구성했다. 그리고 duckdns나 iptime dns를 이용하여 도메인을 구하고 외부에서 안전한 접근이 가능하도록 구현했다.

**맥북 포트포워딩**
노트북을 맥북으로 이용하는데 윈도우에서는 스토리지 접근이 쉽게 되지만 맥북은 그렇지 않았다. 파일서비스에 AFP 프로토콜을 이용하면 됐는데 자주 끊기는 현상이 발생해서 꽤나 애를 먹었다. 그러던 AFP 프로토콜 포트를 내외부 포트포워딩 고정했더니 문제가 사라졌다.

**윈도우 강제 업데이트로 데스크톱 종료**
정말 가끔 데스크톱이 꺼지기도 했다. 윈도우가 강제 업데이트 되어서 재부팅되거나 부모님이 실수로 청소기를 밀다가 꺼버리거나. 완전히 전원 케이블이 분리됐다면 살릴 수 없지만 그게 아니라면 WOL 기능을 사용해서 다시 킬 수 있다. 그리고 정말 다행인게 구글 원격 제어라는 프로그램으로 편리하게 내 데스크톱을 외부에서도 설정가능하다.

포트를 열어서 터미널 접근도 가능하도록 설정하려다 굳이 필요없어서 진행은 하지 않았다.

**스토리지 백업**
비싼 돈주고 HDD를 구매했지만 사례 중에 HDD가 고장나는 경우가 있다는 것을 확인했다. 그래서 저렴한 3TB HDD를 구매해서 일주일에 수요일, 일요일에만 새벽 3시부터 전체 백업을 진행하도록 설정했다. 따라서 안전하게 나의 소중한 데이터를 보장할 수 있다.

**전기료**
계산했을 때 컴퓨터를 24시간 켜놨을 때 2만원 비용이 들거라 예상했다. 다행히도 저전력 부품을 사용하고 데이터 이용을 하지 않았을 시 자동으로 off 모드를 설정해두니 1만원 안팎의 비용이 발생했다. 첫 달에 고지서를 얼마나 기다렸는지 모른다...
